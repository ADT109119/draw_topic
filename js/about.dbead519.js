"use strict";(self["webpackChunkdraw_topic"]=self["webpackChunkdraw_topic"]||[]).push([[443],{833:function(e,a,t){t.r(a),t.d(a,{default:function(){return d}});var l=t(3396);const n={class:"about"},s=(0,l._)("h1",null,"This is an about page",-1),i=[s];function o(e,a){return(0,l.wg)(),(0,l.iD)("div",n,i)}var r=t(89);const u={},c=(0,r.Z)(u,[["render",o]]);var d=c},6544:function(e,a,t){t.r(a),t.d(a,{default:function(){return le}});t(7658);var l=t(3396),n=t(9242),s=t(4870),i=t(7139),o=t(2483),r=t(65);const u={class:"memberList"},c=(0,l._)("i",{class:"material-icons"},"account_circle",-1);var d={__name:"memberList",props:{membersdata:{type:Array}},setup(e){const a=e;return(e,t)=>((0,l.wg)(),(0,l.iD)("ul",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.membersdata,((e,a)=>((0,l.wg)(),(0,l.iD)("li",{class:"listItem",key:a},[c,(0,l._)("span",null,(0,i.zw)(e.username),1)])))),128))]))}};const p=d;var v=p,m=t(7585);const g={class:"settingContainer"},b={class:"setting col-10 col-md-4 col-sm-8"},f={class:"switcher"},_=(0,l._)("hr",{style:{margin:"0 4px"}},null,-1),h={class:"content"},w=["hidden"],y=(0,l._)("span",null,"列數:",-1),k=(0,l._)("span",null,"行數:",-1),N=["hidden"];var S={__name:"sideBar",props:{membersdata:{type:Array}},emits:["changeSetting"],setup(e,{expose:a,emit:t}){const o=e,u=(0,r.oR)(),c=(0,s.iH)(),d=(0,s.iH)(1),p=(0,s.iH)(1),S=(0,s.iH)(),x=(0,s.iH)(),C=(0,s.iH)(0),H=()=>{console.log([d.value,p.value]),t("changeSetting",[d.value,p.value])},O=()=>{c.value.classList.remove("active")},J=e=>{C.value=e};a({changeTab:J});const D=e=>new Promise((a=>{let t=[],l=JSON.parse(JSON.stringify(e.colName));l.splice(0,0,"項目"),t.push(l),e["data"].map(((a,l)=>{let n=JSON.parse(JSON.stringify(a));n.splice(0,0,e.rowName[l]),t.push(n)})),console.log(t),a(t)})),U=e=>{let a="";e.map((e=>{let t=e.join(",")+"\n";a+=t})),console.log(a);let t="搶籤資料_"+(new Date).getTime()+".csv",l=document.createElement("a");l.setAttribute("href","data:text/csv;charset=utf-8,%EF%BB%BF"+encodeURI(a)),l.setAttribute("download",t),l.click()},I=()=>{D(u.getters.getData).then((e=>{U(e)}))};return(e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"sidebar",ref_key:"sidebar",ref:c},[(0,l._)("div",{class:"sidebarBackfround",onClick:O}),(0,l._)("div",g,[(0,l._)("div",b,[(0,l._)("div",{style:{"text-align":"right",padding:"0 1rem"}},[(0,l._)("span",{class:"closeSidebarButton",onClick:O},"×")]),(0,l._)("div",f,[(0,l._)("span",{class:(0,i.C_)(0==C.value?"active":""),onClick:a[0]||(a[0]=e=>J(0))},"設定",2),(0,l._)("span",{class:(0,i.C_)(1==C.value?"active":""),onClick:a[1]||(a[1]=e=>J(1))},"成員",2)]),_,(0,l._)("div",h,[(0,l._)("section",{class:"settingTab",ref_key:"settingTab",ref:S,hidden:0==!C.value},[y,(0,l.wy)((0,l._)("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>d.value=e),min:"1",onInput:H},null,544),[[n.nr,d.value]]),k,(0,l.wy)((0,l._)("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),min:"1",onInput:H},null,544),[[n.nr,p.value]]),(0,l.Wm)(m.Z,{onClick:I},{default:(0,l.w5)((()=>[(0,l.Uk)("下載CSV")])),_:1})],8,w),(0,l._)("section",{class:"memberTab",ref_key:"memberTab",ref:x,hidden:1==!C.value},[(0,l.Wm)(v,{membersdata:o.membersdata},null,8,["membersdata"])],8,N)])])])],512))}};const x=S;var C=x;const H=(0,l._)("div",{class:"enterNameWindowBackground"},null,-1),O={class:"enterNameWindow col-12 col-md-6 col-sm-8"},J=(0,l._)("div",{class:"title"},"請輸入名稱",-1),D=(0,l._)("hr",null,null,-1),U={class:"input-group",style:{"margin-top":"1rem"}};var I={__name:"enterNameWindow",emits:["username"],setup(e,{emit:a}){const t=(0,s.iH)(""),i=(0,s.iH)("請輸入名稱"),o=()=>{i.value=""==t.value?"請輸入名稱":"加入房間"},r=()=>{""!=t.value&&(a("username",t.value),i.value='<span class="spinner-border spinner-border-sm" style="font-size: 0.6rem"></span>')};return(e,a)=>((0,l.wg)(),(0,l.iD)("div",null,[H,(0,l._)("div",O,[J,D,(0,l._)("div",U,[(0,l.wy)((0,l._)("input",{class:"username form-control","onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),onInput:o,placeholder:"請輸入名稱"},null,544),[[n.nr,t.value]]),(0,l.Wm)(m.Z,{style:{"--bor":"0 4px 4px 0"},onClick:r,innerHTML:i.value},null,8,["innerHTML"])])])]))}};const T=I;var B=T;const A={class:"container"},L={style:{color:"green",display:"flex","justify-content":"center","font-size":"1.2rem"}},W=(0,l._)("i",{class:"material-icons"},"check",-1),z={style:{color:"red",display:"flex","justify-content":"center","font-size":"1.2rem"}},j=(0,l._)("i",{class:"material-icons"},"not_interested",-1),Y={class:"tableContainer table-responsive mt-1"},E={class:"table table-bordered"},F={class:"table-light"},R=(0,l._)("th",null,"項目",-1),V=["onInput","contenteditable"],K=["onClick","onInput","contenteditable"],q=["onInput","contenteditable"],M={class:"functions"},P=["data-num"],Z=(0,l._)("i",{class:"material-icons"},"people",-1),$=[Z],G=(0,l._)("i",{class:"material-icons"},"check",-1),Q=[G],X=(0,l._)("i",{class:"material-icons"},"not_interested",-1),ee=[X];var ae={__name:"RoomView",setup(e){const a=(0,o.yj)(),t=(0,r.oR)(),u=(0,s.iH)({rowName:["項目1"],colName:["名額1"],data:[[""]],drawAuthSwitch:!0});console.log(a.params.id);const c=(0,s.iH)(),d=a.params.id,p=t.getters.getPeerjsObj,v=(0,s.iH)(""),m=(0,s.iH)(!1);let g;const b=(0,s.iH)([]),f=(0,s.iH)([]);var _=[],h=[];(0,l.bv)((()=>{b.value=[],_=[],t.dispatch("setData",u.value),g=setInterval((()=>{null!=p.id?(clearInterval(g),p.id==d&&(g=setInterval((()=>{H({type:"text",data:JSON.stringify(u.value)}),H({type:"usersList",data:JSON.stringify(f.value)})}),1e3))):console.log("not")}),1e3);var e=[].slice.call(document.querySelectorAll('[data-toggle="tooltip"]'));e.map((function(e){let a;return e.onmouseenter=()=>{let t=e.getBoundingClientRect();a=document.createElement("div"),a.className="tooltip bs-tooltip-auto fade show",a.style=`position: absolute; inset: auto auto 0px 0px; margin: 0px; left:${t.left}px; top: ${t.bottom}px;`,a.innerHTML=`<div class="tooltip-arrow" style="position: absolute; left: 0px; transform: translate3d(28px, 0px, 0px);"></div><div class="tooltip-inner">${e.dataset.tooltip}</div>`,document.body.append(a)},e.onmouseleave=()=>{a.remove()},a}))}));const w=e=>{null!=p.id&&""!=e&&void 0!=e&&(v.value=e,x(JSON.stringify({id:d,username:"房主"})))},y=e=>{p.id==d?u.value.drawAuthSwitch=e:alert("您不是房主")},k=e=>{H({type:"draw",data:e})},N=e=>{if(e[0]<1&&(e[0]=1),e[1]<1&&(e[1]=1),u.value.rowName.length<e[0]){let a=u.value.rowName.length;for(let t=a;t<e[0];t++){u.value.rowName.push("新項目");let a=[];for(let t=0;t<e[1];t++)a.push("");u.value.data.push(JSON.parse(JSON.stringify(a)))}}else u.value.rowName=u.value.rowName.slice(0,e[0]),u.value.data=u.value.data.slice(0,e[0]);if(u.value.colName.length<e[1]){let a=u.value.colName.length;for(let t=a;t<e[1];t++){u.value.colName.push("新名額");for(let e=0;e<u.value.data.length;e++)u.value.data[e].push("")}}else{u.value.colName=u.value.colName.slice(0,e[1]);for(let a=0;a<u.value.data.length;a++)u.value.data[a]=u.value.data[a].slice(0,e[1])}},S=(e,a,t)=>{t.preventDefault(),-1==e&&(u.value.colName[a]=t.target.textContent.replace(/\n/gi,"")),-1==a&&(u.value.rowName[e]=t.target.textContent.replace(/\n/gi,"")),-1!=e&&-1!=a&&(u.value.data[e][a]=t.target.textContent.replace(/\n/gi,""))};function x(e){let a=JSON.parse(e),t=a["id"],l=a["username"];if(b.value.includes(t))return;console.log(t),b.value.push(t);let n={id:t,username:l};f.value.push(JSON.parse(JSON.stringify(n)));var s=p.connect(t);s.on("open",(function(){let e={type:"conn",data:JSON.stringify({id:p.id,username:v.value})};s.send(JSON.stringify(e)),_.push(s)}))}function H(e){e=JSON.stringify(e),_.forEach((a=>{a.send(e)}))}return(0,l.YP)(u.value,(e=>{H({type:"text",data:JSON.stringify(e)}),t.dispatch("setData",u.value)})),p.on("connection",(function(e){e.on("data",(function(a){switch(a=JSON.parse(a),a["type"]){case"conn":e.peer==d&&(m.value=!0),x(a["data"]);break;case"text":if(p.id==d)break;u.value=JSON.parse(a["data"]);break;case"draw":if(0==u.value.drawAuthSwitch)break;var t="";for(let a=0;a<f.value.length;a++)if(f.value[a].id==e.peer){t=f.value[a].username;break}if(h.includes(e.peer))break;var l=parseInt(a["data"]);for(let a=0;a<u.value.colName.length;a++)if(""==u.value.data[l][a]&&(u.value.data[l][a]=t,u.value.data[l][a]==t)){h.push(e.peer);break}break;case"usersList":if(p.id==d)break;f.value=JSON.parse(a["data"]);break;default:break}}))})),(e,a)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",A,[(0,l._)("div",null,[(0,l.wy)((0,l._)("span",L,[W,(0,l.Uk)(" 目前可搶籤")],512),[[n.F8,u.value.drawAuthSwitch]]),(0,l.wy)((0,l._)("span",z,[j,(0,l.Uk)(" 目前不可搶籤")],512),[[n.F8,!u.value.drawAuthSwitch]])]),(0,l._)("div",Y,[(0,l._)("table",E,[(0,l._)("thead",F,[(0,l._)("tr",null,[R,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(u.value.colName,((e,a)=>((0,l.wg)(),(0,l.iD)("th",{key:a,role:"textbox",onInput:e=>S(-1,a,e),contenteditable:(0,s.SU)(p).id==(0,s.SU)(d)},(0,i.zw)(e),41,V)))),128))])]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(u.value.rowName,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:a},[(0,l._)("td",{class:(0,i.C_)("table-light "+((0,s.SU)(p).id!=(0,s.SU)(d)?"drawButton":"")),onClick:e=>k(a),role:"textbox",onInput:e=>S(a,-1,e),contenteditable:(0,s.SU)(p).id==(0,s.SU)(d)},(0,i.zw)(e),43,K),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(u.value.data[a],((e,t)=>((0,l.wg)(),(0,l.iD)("td",{key:t,onInput:e=>S(a,t,e),role:"textbox",contenteditable:(0,s.SU)(p).id==(0,s.SU)(d)},(0,i.zw)(e),41,q)))),128))])))),128))])])])]),(0,l.Wm)(C,{ref_key:"sideBarElement",ref:c,onChangeSetting:N,membersdata:f.value},null,8,["membersdata"]),(0,l._)("span",M,[(0,l._)("span",null,[(0,l._)("span",null,[(0,l._)("i",{class:"material-icons",onClick:a[0]||(a[0]=e=>c.value.changeTab(0)),onclick:"document.querySelector('.sidebar').classList.add('active');"},"settings")]),(0,l._)("span",{class:"peopleButton",onClick:a[1]||(a[1]=e=>c.value.changeTab(1)),onclick:"document.querySelector('.sidebar').classList.add('active');","data-num":f.value.length},$,8,P),(0,l._)("span",{"data-toggle":"tooltip","data-tooltip":"允許填寫!",onClick:a[2]||(a[2]=e=>y(!0))},Q),(0,l._)("span",{"data-toggle":"tooltip","data-tooltip":"關閉填寫!",onClick:a[3]||(a[3]=e=>y(!1))},ee)])]),(0,l.wy)((0,l.Wm)(B,{onUsername:w},null,512),[[n.F8,(0,s.SU)(p).id!=(0,s.SU)(d)&&!m.value]])],64))}};const te=ae;var le=te}}]);
//# sourceMappingURL=about.dbead519.js.map