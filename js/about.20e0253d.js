"use strict";(self["webpackChunkdraw_topic"]=self["webpackChunkdraw_topic"]||[]).push([[594],{603:function(e,a,t){t.r(a),t.d(a,{default:function(){return c}});var l=t(6768);const n={class:"about"};function s(e,a){return(0,l.uX)(),(0,l.CE)("div",n,a[0]||(a[0]=[(0,l.Lk)("h1",null,"This is an about page",-1)]))}var o=t(1241);const i={},r=(0,o.A)(i,[["render",s]]);var c=r},5201:function(e,a,t){t.r(a),t.d(a,{default:function(){return G}});t(4114);var l=t(6768),n=t(5130),s=t(144),o=t(4232),i=t(1387),r=t(782);const c={class:"memberList"};var u={__name:"memberList",props:{membersdata:{type:Array}},setup(e){const a=e;return(e,t)=>((0,l.uX)(),(0,l.CE)("ul",c,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.membersdata,((e,a)=>((0,l.uX)(),(0,l.CE)("li",{class:"listItem",key:a},[t[0]||(t[0]=(0,l.Lk)("i",{class:"material-icons"},"account_circle",-1)),(0,l.Lk)("span",null,(0,o.v_)(e.username),1)])))),128))]))}};const d=u;var p=d,v=t(9938);const m={class:"settingContainer"},k={class:"setting col-10 col-md-4 col-sm-8"},b={class:"switcher"},g={class:"content"},h=["hidden"],f=["hidden"];var L={__name:"sideBar",props:{membersdata:{type:Array}},emits:["changeSetting"],setup(e,{expose:a,emit:t}){const i=(0,r.Pj)(),c=(0,s.KR)(),u=(0,s.KR)(1),d=(0,s.KR)(1),L=(0,s.KR)(),y=(0,s.KR)(),C=(0,s.KR)(0),w=e,N=t,S=()=>{console.log([u.value,d.value]),N("changeSetting",[u.value,d.value])},R=()=>{c.value.classList.remove("active")},x=e=>{C.value=e};a({changeTab:x});const _=e=>new Promise((a=>{let t=[],l=JSON.parse(JSON.stringify(e.colName));l.splice(0,0,"項目"),t.push(l),e["data"].map(((a,l)=>{let n=JSON.parse(JSON.stringify(a));n.splice(0,0,e.rowName[l]),t.push(n)})),console.log(t),a(t)})),J=e=>{let a="";e.map((e=>{let t=e.join(",")+"\n";a+=t})),console.log(a);let t="搶籤資料_"+(new Date).getTime()+".csv",l=document.createElement("a");l.setAttribute("href","data:text/csv;charset=utf-8,%EF%BB%BF"+encodeURI(a)),l.setAttribute("download",t),l.click()},I=()=>{_(i.getters.getData).then((e=>{J(e)}))};return(e,a)=>((0,l.uX)(),(0,l.CE)("div",{class:"sidebar",ref_key:"sidebar",ref:c},[(0,l.Lk)("div",{class:"sidebarBackfround",onClick:R}),(0,l.Lk)("div",m,[(0,l.Lk)("div",k,[(0,l.Lk)("div",{style:{"text-align":"right",padding:"0 1rem"}},[(0,l.Lk)("span",{class:"closeSidebarButton",onClick:R},"×")]),(0,l.Lk)("div",b,[(0,l.Lk)("span",{class:(0,o.C4)(0==C.value?"active":""),onClick:a[0]||(a[0]=e=>x(0))},"設定",2),(0,l.Lk)("span",{class:(0,o.C4)(1==C.value?"active":""),onClick:a[1]||(a[1]=e=>x(1))},"成員",2)]),a[7]||(a[7]=(0,l.Lk)("hr",{style:{margin:"0 4px"}},null,-1)),(0,l.Lk)("div",g,[(0,l.Lk)("section",{class:"settingTab",ref_key:"settingTab",ref:L,hidden:0==!C.value},[a[5]||(a[5]=(0,l.Lk)("span",null,"列數:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>u.value=e),min:"1",onInput:S},null,544),[[n.Jo,u.value]]),a[6]||(a[6]=(0,l.Lk)("span",null,"行數:",-1)),(0,l.bo)((0,l.Lk)("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>d.value=e),min:"1",onInput:S},null,544),[[n.Jo,d.value]]),(0,l.bF)(v.A,{onClick:I},{default:(0,l.k6)((()=>a[4]||(a[4]=[(0,l.eW)("下載CSV")]))),_:1})],8,h),(0,l.Lk)("section",{class:"memberTab",ref_key:"memberTab",ref:y,hidden:1==!C.value},[(0,l.bF)(p,{membersdata:w.membersdata},null,8,["membersdata"])],8,f)])])])],512))}};const y=L;var C=y;const w={class:"enterNameWindow col-12 col-md-6 col-sm-8"},N={class:"input-group",style:{"margin-top":"1rem"}};var S={__name:"enterNameWindow",emits:["username"],setup(e,{emit:a}){const t=(0,s.KR)(""),o=(0,s.KR)("請輸入名稱"),i=()=>{o.value=""==t.value?"請輸入名稱":"加入房間"},r=a,c=()=>{""!=t.value&&(r("username",t.value),o.value='<span class="spinner-border spinner-border-sm" style="font-size: 0.6rem"></span>')};return(e,a)=>((0,l.uX)(),(0,l.CE)("div",null,[a[3]||(a[3]=(0,l.Lk)("div",{class:"enterNameWindowBackground"},null,-1)),(0,l.Lk)("div",w,[a[1]||(a[1]=(0,l.Lk)("div",{class:"title"},"請輸入名稱",-1)),a[2]||(a[2]=(0,l.Lk)("hr",null,null,-1)),(0,l.Lk)("div",N,[(0,l.bo)((0,l.Lk)("input",{class:"username form-control","onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),onInput:i,placeholder:"請輸入名稱"},null,544),[[n.Jo,t.value]]),(0,l.bF)(v.A,{style:{"--bor":"0 4px 4px 0"},onClick:c,innerHTML:o.value},null,8,["innerHTML"])])])]))}};const R=S;var x=R;const _={class:"qrcodeDisplayWindowConatiner close"},J={class:"qrcodeDisplayWindow col-12 col-md-6 col-sm-8"},I={class:"input-group",style:{"margin-top":"1rem"}},K=["src"];var O={__name:"qrcodeDisplayWindow",props:{url:{type:String}},setup(e){const a=e;return(e,t)=>((0,l.uX)(),(0,l.CE)("div",_,[t[3]||(t[3]=(0,l.Lk)("div",{class:"qrcodeDisplayWindowBackground"},null,-1)),(0,l.Lk)("div",J,[t[0]||(t[0]=(0,l.Lk)("div",{class:"title"},"房間QR Code",-1)),t[1]||(t[1]=(0,l.Lk)("span",{class:"closeButton",onclick:"document.querySelector('.qrcodeDisplayWindowConatiner').classList.add('close')"},"×",-1)),t[2]||(t[2]=(0,l.Lk)("hr",null,null,-1)),(0,l.Lk)("div",I,[(0,l.Lk)("img",{style:{margin:"auto"},src:`https://chart.googleapis.com/chart?cht=qr&chs=256x256&chl=${a.url}`},null,8,K)])])]))}};const E=O;var q=E;const B={class:"container"},X={style:{color:"green",display:"flex","justify-content":"center","font-size":"1.2rem"}},A={style:{color:"red",display:"flex","justify-content":"center","font-size":"1.2rem"}},F={class:"tableContainer table-responsive mt-1"},T={class:"table table-bordered"},W={class:"table-light"},D=["onInput","contenteditable"],j=["onClick","onInput","contenteditable"],U=["onInput","contenteditable"],V={class:"functions"},P=["data-num"];var $={__name:"RoomView",setup(e){const a=(0,i.lq)(),t=(0,r.Pj)(),c=(0,s.KR)({rowName:["項目1"],colName:["名額1"],data:[[""]],drawAuthSwitch:!0});console.log(a.params.id);const u=(0,s.KR)(),d=a.params.id,p=t.getters.getPeerjsObj,v=(0,s.KR)(""),m=(0,s.KR)(!1);let k;const b=(0,s.KR)([]),g=(0,s.KR)([]);var h=[],f=[];(0,l.sV)((()=>{b.value=[],h=[],t.dispatch("setData",c.value),k=setInterval((()=>{null!=p.id?(clearInterval(k),p.id==d&&(k=setInterval((()=>{_({type:"text",data:JSON.stringify(c.value)}),_({type:"usersList",data:JSON.stringify(g.value)})}),1e3))):console.log("not")}),1e3);var e=[].slice.call(document.querySelectorAll('[data-toggle="tooltip"]'));e.map((function(e){let a;return e.onmouseenter=()=>{let t=e.getBoundingClientRect();a=document.createElement("div"),a.className="tooltip bs-tooltip-auto fade show",a.style=`position: absolute; inset: auto auto 0px 0px; margin: 0px; left:${t.left}px; top: ${t.bottom}px;`,a.innerHTML=`<div class="tooltip-arrow" style="position: absolute; left: 0px; transform: translate3d(28px, 0px, 0px);"></div><div class="tooltip-inner">${e.dataset.tooltip}</div>`,document.body.append(a)},e.onmouseleave=()=>{a.remove()},a}))}));const L=e=>{null!=p.id&&""!=e&&void 0!=e&&(v.value=e,R(JSON.stringify({id:d,username:"房主"})))},y=e=>{p.id==d?c.value.drawAuthSwitch=e:alert("您不是房主")},w=e=>{_({type:"draw",data:e})},N=e=>{if(e[0]<1&&(e[0]=1),e[1]<1&&(e[1]=1),c.value.rowName.length<e[0]){let a=c.value.rowName.length;for(let t=a;t<e[0];t++){c.value.rowName.push("新項目");let a=[];for(let t=0;t<e[1];t++)a.push("");c.value.data.push(JSON.parse(JSON.stringify(a)))}}else c.value.rowName=c.value.rowName.slice(0,e[0]),c.value.data=c.value.data.slice(0,e[0]);if(c.value.colName.length<e[1]){let a=c.value.colName.length;for(let t=a;t<e[1];t++){c.value.colName.push("新名額");for(let e=0;e<c.value.data.length;e++)c.value.data[e].push("")}}else{c.value.colName=c.value.colName.slice(0,e[1]);for(let a=0;a<c.value.data.length;a++)c.value.data[a]=c.value.data[a].slice(0,e[1])}},S=(e,a,t)=>{t.preventDefault(),-1==e&&(c.value.colName[a]=t.target.textContent.replace(/\n/gi,"")),-1==a&&(c.value.rowName[e]=t.target.textContent.replace(/\n/gi,"")),-1!=e&&-1!=a&&(c.value.data[e][a]=t.target.textContent.replace(/\n/gi,""))};function R(e){let a=JSON.parse(e),t=a["id"],l=a["username"];if(b.value.includes(t))return;console.log(t),b.value.push(t);let n={id:t,username:l};g.value.push(JSON.parse(JSON.stringify(n)));var s=p.connect(t);s.on("open",(function(){let e={type:"conn",data:JSON.stringify({id:p.id,username:v.value})};s.send(JSON.stringify(e)),h.push(s)}))}function _(e){e=JSON.stringify(e),h.forEach((a=>{a.send(e)}))}(0,l.wB)(c.value,(e=>{_({type:"text",data:JSON.stringify(e)}),t.dispatch("setData",c.value)})),p.on("connection",(function(e){e.on("data",(function(a){switch(a=JSON.parse(a),a["type"]){case"conn":e.peer==d&&(m.value=!0),R(a["data"]);break;case"text":if(p.id==d)break;c.value=JSON.parse(a["data"]);break;case"draw":if(0==c.value.drawAuthSwitch)break;var t="";for(let a=0;a<g.value.length;a++)if(g.value[a].id==e.peer){t=g.value[a].username;break}if(f.includes(e.peer))break;var l=parseInt(a["data"]);for(let a=0;a<c.value.colName.length;a++)if(""==c.value.data[l][a]&&(c.value.data[l][a]=t,c.value.data[l][a]==t)){f.push(e.peer);break}break;case"usersList":if(p.id==d)break;g.value=JSON.parse(a["data"]);break;default:break}}))}));const J=(0,s.KR)(""),I=()=>{J.value=encodeURIComponent(location.href),document.querySelector(".qrcodeDisplayWindowConatiner").classList.remove("close")};return(e,a)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",B,[(0,l.Lk)("div",null,[(0,l.bo)((0,l.Lk)("span",X,a[4]||(a[4]=[(0,l.Lk)("i",{class:"material-icons"},"check",-1),(0,l.eW)(" 目前可搶籤")]),512),[[n.aG,c.value.drawAuthSwitch]]),(0,l.bo)((0,l.Lk)("span",A,a[5]||(a[5]=[(0,l.Lk)("i",{class:"material-icons"},"not_interested",-1),(0,l.eW)(" 目前不可搶籤")]),512),[[n.aG,!c.value.drawAuthSwitch]])]),(0,l.Lk)("div",F,[(0,l.Lk)("table",T,[(0,l.Lk)("thead",W,[(0,l.Lk)("tr",null,[a[6]||(a[6]=(0,l.Lk)("th",null,"項目",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(c.value.colName,((e,a)=>((0,l.uX)(),(0,l.CE)("th",{key:a,role:"textbox",onInput:e=>S(-1,a,e),contenteditable:(0,s.R1)(p).id==(0,s.R1)(d)},(0,o.v_)(e),41,D)))),128))])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(c.value.rowName,((e,a)=>((0,l.uX)(),(0,l.CE)("tr",{key:a},[(0,l.Lk)("td",{class:(0,o.C4)("table-light "+((0,s.R1)(p).id!=(0,s.R1)(d)?"drawButton":"")),onClick:e=>w(a),role:"textbox",onInput:e=>S(a,-1,e),contenteditable:(0,s.R1)(p).id==(0,s.R1)(d)},(0,o.v_)(e),43,j),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(c.value.data[a],((e,t)=>((0,l.uX)(),(0,l.CE)("td",{key:t,onInput:e=>S(a,t,e),role:"textbox",contenteditable:(0,s.R1)(p).id==(0,s.R1)(d)},(0,o.v_)(e),41,U)))),128))])))),128))])])])]),(0,l.bF)(C,{ref_key:"sideBarElement",ref:u,onChangeSetting:N,membersdata:g.value},null,8,["membersdata"]),(0,l.Lk)("span",V,[(0,l.Lk)("span",null,[(0,l.Lk)("span",null,[(0,l.Lk)("i",{class:"material-icons",onClick:a[0]||(a[0]=e=>u.value.changeTab(0)),onclick:"document.querySelector('.sidebar').classList.add('active');"},"settings")]),(0,l.Lk)("span",{class:"peopleButton",onClick:a[1]||(a[1]=e=>u.value.changeTab(1)),onclick:"document.querySelector('.sidebar').classList.add('active');","data-num":g.value.length},a[7]||(a[7]=[(0,l.Lk)("i",{class:"material-icons"},"people",-1)]),8,P),(0,l.Lk)("span",{"data-toggle":"tooltip","data-tooltip":"允許填寫!",onClick:a[2]||(a[2]=e=>y(!0))},a[8]||(a[8]=[(0,l.Lk)("i",{class:"material-icons"},"check",-1)])),(0,l.Lk)("span",{"data-toggle":"tooltip","data-tooltip":"關閉填寫!",onClick:a[3]||(a[3]=e=>y(!1))},a[9]||(a[9]=[(0,l.Lk)("i",{class:"material-icons"},"not_interested",-1)])),(0,l.Lk)("span",{"data-toggle":"tooltip","data-tooltip":"顯示 QR Code",onClick:I},a[10]||(a[10]=[(0,l.Lk)("i",{class:"material-icons"},"qr_code",-1)]))])]),(0,l.bo)((0,l.bF)(x,{onUsername:L},null,512),[[n.aG,(0,s.R1)(p).id!=(0,s.R1)(d)&&!m.value]]),(0,l.bF)(q,{url:J.value},null,8,["url"])],64))}};const z=$;var G=z}}]);
//# sourceMappingURL=about.20e0253d.js.map