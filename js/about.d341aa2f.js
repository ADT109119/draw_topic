"use strict";(self["webpackChunkdraw_topic"]=self["webpackChunkdraw_topic"]||[]).push([[443],{833:function(e,a,t){t.r(a),t.d(a,{default:function(){return d}});var l=t(3396);const n={class:"about"},s=(0,l._)("h1",null,"This is an about page",-1),i=[s];function o(e,a){return(0,l.wg)(),(0,l.iD)("div",n,i)}var r=t(89);const c={},u=(0,r.Z)(c,[["render",o]]);var d=u},5880:function(e,a,t){t.r(a),t.d(a,{default:function(){return _e}});t(7658);var l=t(3396),n=t(9242),s=t(4870),i=t(7139),o=t(2483),r=t(65);const c={class:"memberList"},u=(0,l._)("i",{class:"material-icons"},"account_circle",-1);var d={__name:"memberList",props:{membersdata:{type:Array}},setup(e){const a=e;return(e,t)=>((0,l.wg)(),(0,l.iD)("ul",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.membersdata,((e,a)=>((0,l.wg)(),(0,l.iD)("li",{class:"listItem",key:a},[u,(0,l._)("span",null,(0,i.zw)(e.username),1)])))),128))]))}};const p=d;var v=p,m=t(7585);const g={class:"settingContainer"},_={class:"setting col-10 col-md-4 col-sm-8"},h={class:"switcher"},b=(0,l._)("hr",{style:{margin:"0 4px"}},null,-1),f={class:"content"},w=["hidden"],y=(0,l._)("span",null,"列數:",-1),k=(0,l._)("span",null,"行數:",-1),S=["hidden"];var N={__name:"sideBar",props:{membersdata:{type:Array}},emits:["changeSetting"],setup(e,{expose:a,emit:t}){const o=e,c=(0,r.oR)(),u=(0,s.iH)(),d=(0,s.iH)(1),p=(0,s.iH)(1),N=(0,s.iH)(),C=(0,s.iH)(),x=(0,s.iH)(0),D=()=>{console.log([d.value,p.value]),t("changeSetting",[d.value,p.value])},H=()=>{u.value.classList.remove("active")},O=e=>{x.value=e};a({changeTab:O});const J=e=>new Promise((a=>{let t=[],l=JSON.parse(JSON.stringify(e.colName));l.splice(0,0,"項目"),t.push(l),e["data"].map(((a,l)=>{let n=JSON.parse(JSON.stringify(a));n.splice(0,0,e.rowName[l]),t.push(n)})),console.log(t),a(t)})),U=e=>{let a="";e.map((e=>{let t=e.join(",")+"\n";a+=t})),console.log(a);let t="搶籤資料_"+(new Date).getTime()+".csv",l=document.createElement("a");l.setAttribute("href","data:text/csv;charset=utf-8,%EF%BB%BF"+encodeURI(a)),l.setAttribute("download",t),l.click()},I=()=>{J(c.getters.getData).then((e=>{U(e)}))};return(e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"sidebar",ref_key:"sidebar",ref:u},[(0,l._)("div",{class:"sidebarBackfround",onClick:H}),(0,l._)("div",g,[(0,l._)("div",_,[(0,l._)("div",{style:{"text-align":"right",padding:"0 1rem"}},[(0,l._)("span",{class:"closeSidebarButton",onClick:H},"×")]),(0,l._)("div",h,[(0,l._)("span",{class:(0,i.C_)(0==x.value?"active":""),onClick:a[0]||(a[0]=e=>O(0))},"設定",2),(0,l._)("span",{class:(0,i.C_)(1==x.value?"active":""),onClick:a[1]||(a[1]=e=>O(1))},"成員",2)]),b,(0,l._)("div",f,[(0,l._)("section",{class:"settingTab",ref_key:"settingTab",ref:N,hidden:0==!x.value},[y,(0,l.wy)((0,l._)("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>d.value=e),min:"1",onInput:D},null,544),[[n.nr,d.value]]),k,(0,l.wy)((0,l._)("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),min:"1",onInput:D},null,544),[[n.nr,p.value]]),(0,l.Wm)(m.Z,{onClick:I},{default:(0,l.w5)((()=>[(0,l.Uk)("下載CSV")])),_:1})],8,w),(0,l._)("section",{class:"memberTab",ref_key:"memberTab",ref:C,hidden:1==!x.value},[(0,l.Wm)(v,{membersdata:o.membersdata},null,8,["membersdata"])],8,S)])])])],512))}};const C=N;var x=C;const D=(0,l._)("div",{class:"enterNameWindowBackground"},null,-1),H={class:"enterNameWindow col-12 col-md-6 col-sm-8"},O=(0,l._)("div",{class:"title"},"請輸入名稱",-1),J=(0,l._)("hr",null,null,-1),U={class:"input-group",style:{"margin-top":"1rem"}};var I={__name:"enterNameWindow",emits:["username"],setup(e,{emit:a}){const t=(0,s.iH)(""),i=(0,s.iH)("請輸入名稱"),o=()=>{i.value=""==t.value?"請輸入名稱":"加入房間"},r=()=>{""!=t.value&&(a("username",t.value),i.value='<span class="spinner-border spinner-border-sm" style="font-size: 0.6rem"></span>')};return(e,a)=>((0,l.wg)(),(0,l.iD)("div",null,[D,(0,l._)("div",H,[O,J,(0,l._)("div",U,[(0,l.wy)((0,l._)("input",{class:"username form-control","onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),onInput:o,placeholder:"請輸入名稱"},null,544),[[n.nr,t.value]]),(0,l.Wm)(m.Z,{style:{"--bor":"0 4px 4px 0"},onClick:r,innerHTML:i.value},null,8,["innerHTML"])])])]))}};const W=I;var q=W;const B={class:"qrcodeDisplayWindowConatiner close"},L=(0,l._)("div",{class:"qrcodeDisplayWindowBackground"},null,-1),T={class:"qrcodeDisplayWindow col-12 col-md-6 col-sm-8"},A=(0,l._)("div",{class:"title"},"房間QR Code",-1),R=(0,l._)("span",{class:"closeButton",onclick:"document.querySelector('.qrcodeDisplayWindowConatiner').classList.add('close')"},"×",-1),z=(0,l._)("hr",null,null,-1),j={class:"input-group",style:{"margin-top":"1rem"}},Y=["src"];var E={__name:"qrcodeDisplayWindow",props:{url:{type:String}},setup(e){const a=e;return(e,t)=>((0,l.wg)(),(0,l.iD)("div",B,[L,(0,l._)("div",T,[A,R,z,(0,l._)("div",j,[(0,l._)("img",{style:{margin:"auto"},src:`https://chart.googleapis.com/chart?cht=qr&chs=256x256&chl=${a.url}`},null,8,Y)])])]))}};const F=E;var V=F;const K={class:"container"},$={style:{color:"green",display:"flex","justify-content":"center","font-size":"1.2rem"}},M=(0,l._)("i",{class:"material-icons"},"check",-1),P={style:{color:"red",display:"flex","justify-content":"center","font-size":"1.2rem"}},Z=(0,l._)("i",{class:"material-icons"},"not_interested",-1),Q={class:"tableContainer table-responsive mt-1"},G={class:"table table-bordered"},X={class:"table-light"},ee=(0,l._)("th",null,"項目",-1),ae=["onInput","contenteditable"],te=["onClick","onInput","contenteditable"],le=["onInput","contenteditable"],ne={class:"functions"},se=["data-num"],ie=(0,l._)("i",{class:"material-icons"},"people",-1),oe=[ie],re=(0,l._)("i",{class:"material-icons"},"check",-1),ce=[re],ue=(0,l._)("i",{class:"material-icons"},"not_interested",-1),de=[ue],pe=(0,l._)("i",{class:"material-icons"},"qr_code",-1),ve=[pe];var me={__name:"RoomView",setup(e){const a=(0,o.yj)(),t=(0,r.oR)(),c=(0,s.iH)({rowName:["項目1"],colName:["名額1"],data:[[""]],drawAuthSwitch:!0});console.log(a.params.id);const u=(0,s.iH)(),d=a.params.id,p=t.getters.getPeerjsObj,v=(0,s.iH)(""),m=(0,s.iH)(!1);let g;const _=(0,s.iH)([]),h=(0,s.iH)([]);var b=[],f=[];(0,l.bv)((()=>{_.value=[],b=[],t.dispatch("setData",c.value),g=setInterval((()=>{null!=p.id?(clearInterval(g),p.id==d&&(g=setInterval((()=>{D({type:"text",data:JSON.stringify(c.value)}),D({type:"usersList",data:JSON.stringify(h.value)})}),1e3))):console.log("not")}),1e3);var e=[].slice.call(document.querySelectorAll('[data-toggle="tooltip"]'));e.map((function(e){let a;return e.onmouseenter=()=>{let t=e.getBoundingClientRect();a=document.createElement("div"),a.className="tooltip bs-tooltip-auto fade show",a.style=`position: absolute; inset: auto auto 0px 0px; margin: 0px; left:${t.left}px; top: ${t.bottom}px;`,a.innerHTML=`<div class="tooltip-arrow" style="position: absolute; left: 0px; transform: translate3d(28px, 0px, 0px);"></div><div class="tooltip-inner">${e.dataset.tooltip}</div>`,document.body.append(a)},e.onmouseleave=()=>{a.remove()},a}))}));const w=e=>{null!=p.id&&""!=e&&void 0!=e&&(v.value=e,C(JSON.stringify({id:d,username:"房主"})))},y=e=>{p.id==d?c.value.drawAuthSwitch=e:alert("您不是房主")},k=e=>{D({type:"draw",data:e})},S=e=>{if(e[0]<1&&(e[0]=1),e[1]<1&&(e[1]=1),c.value.rowName.length<e[0]){let a=c.value.rowName.length;for(let t=a;t<e[0];t++){c.value.rowName.push("新項目");let a=[];for(let t=0;t<e[1];t++)a.push("");c.value.data.push(JSON.parse(JSON.stringify(a)))}}else c.value.rowName=c.value.rowName.slice(0,e[0]),c.value.data=c.value.data.slice(0,e[0]);if(c.value.colName.length<e[1]){let a=c.value.colName.length;for(let t=a;t<e[1];t++){c.value.colName.push("新名額");for(let e=0;e<c.value.data.length;e++)c.value.data[e].push("")}}else{c.value.colName=c.value.colName.slice(0,e[1]);for(let a=0;a<c.value.data.length;a++)c.value.data[a]=c.value.data[a].slice(0,e[1])}},N=(e,a,t)=>{t.preventDefault(),-1==e&&(c.value.colName[a]=t.target.textContent.replace(/\n/gi,"")),-1==a&&(c.value.rowName[e]=t.target.textContent.replace(/\n/gi,"")),-1!=e&&-1!=a&&(c.value.data[e][a]=t.target.textContent.replace(/\n/gi,""))};function C(e){let a=JSON.parse(e),t=a["id"],l=a["username"];if(_.value.includes(t))return;console.log(t),_.value.push(t);let n={id:t,username:l};h.value.push(JSON.parse(JSON.stringify(n)));var s=p.connect(t);s.on("open",(function(){let e={type:"conn",data:JSON.stringify({id:p.id,username:v.value})};s.send(JSON.stringify(e)),b.push(s)}))}function D(e){e=JSON.stringify(e),b.forEach((a=>{a.send(e)}))}(0,l.YP)(c.value,(e=>{D({type:"text",data:JSON.stringify(e)}),t.dispatch("setData",c.value)})),p.on("connection",(function(e){e.on("data",(function(a){switch(a=JSON.parse(a),a["type"]){case"conn":e.peer==d&&(m.value=!0),C(a["data"]);break;case"text":if(p.id==d)break;c.value=JSON.parse(a["data"]);break;case"draw":if(0==c.value.drawAuthSwitch)break;var t="";for(let a=0;a<h.value.length;a++)if(h.value[a].id==e.peer){t=h.value[a].username;break}if(f.includes(e.peer))break;var l=parseInt(a["data"]);for(let a=0;a<c.value.colName.length;a++)if(""==c.value.data[l][a]&&(c.value.data[l][a]=t,c.value.data[l][a]==t)){f.push(e.peer);break}break;case"usersList":if(p.id==d)break;h.value=JSON.parse(a["data"]);break;default:break}}))}));const H=(0,s.iH)(""),O=()=>{H.value=encodeURIComponent(location.href),document.querySelector(".qrcodeDisplayWindowConatiner").classList.remove("close")};return(e,a)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",K,[(0,l._)("div",null,[(0,l.wy)((0,l._)("span",$,[M,(0,l.Uk)(" 目前可搶籤")],512),[[n.F8,c.value.drawAuthSwitch]]),(0,l.wy)((0,l._)("span",P,[Z,(0,l.Uk)(" 目前不可搶籤")],512),[[n.F8,!c.value.drawAuthSwitch]])]),(0,l._)("div",Q,[(0,l._)("table",G,[(0,l._)("thead",X,[(0,l._)("tr",null,[ee,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.value.colName,((e,a)=>((0,l.wg)(),(0,l.iD)("th",{key:a,role:"textbox",onInput:e=>N(-1,a,e),contenteditable:(0,s.SU)(p).id==(0,s.SU)(d)},(0,i.zw)(e),41,ae)))),128))])]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.value.rowName,((e,a)=>((0,l.wg)(),(0,l.iD)("tr",{key:a},[(0,l._)("td",{class:(0,i.C_)("table-light "+((0,s.SU)(p).id!=(0,s.SU)(d)?"drawButton":"")),onClick:e=>k(a),role:"textbox",onInput:e=>N(a,-1,e),contenteditable:(0,s.SU)(p).id==(0,s.SU)(d)},(0,i.zw)(e),43,te),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.value.data[a],((e,t)=>((0,l.wg)(),(0,l.iD)("td",{key:t,onInput:e=>N(a,t,e),role:"textbox",contenteditable:(0,s.SU)(p).id==(0,s.SU)(d)},(0,i.zw)(e),41,le)))),128))])))),128))])])])]),(0,l.Wm)(x,{ref_key:"sideBarElement",ref:u,onChangeSetting:S,membersdata:h.value},null,8,["membersdata"]),(0,l._)("span",ne,[(0,l._)("span",null,[(0,l._)("span",null,[(0,l._)("i",{class:"material-icons",onClick:a[0]||(a[0]=e=>u.value.changeTab(0)),onclick:"document.querySelector('.sidebar').classList.add('active');"},"settings")]),(0,l._)("span",{class:"peopleButton",onClick:a[1]||(a[1]=e=>u.value.changeTab(1)),onclick:"document.querySelector('.sidebar').classList.add('active');","data-num":h.value.length},oe,8,se),(0,l._)("span",{"data-toggle":"tooltip","data-tooltip":"允許填寫!",onClick:a[2]||(a[2]=e=>y(!0))},ce),(0,l._)("span",{"data-toggle":"tooltip","data-tooltip":"關閉填寫!",onClick:a[3]||(a[3]=e=>y(!1))},de),(0,l._)("span",{"data-toggle":"tooltip","data-tooltip":"顯示 QR Code",onClick:O},ve)])]),(0,l.wy)((0,l.Wm)(q,{onUsername:w},null,512),[[n.F8,(0,s.SU)(p).id!=(0,s.SU)(d)&&!m.value]]),(0,l.Wm)(V,{url:H.value},null,8,["url"])],64))}};const ge=me;var _e=ge}}]);
//# sourceMappingURL=about.d341aa2f.js.map